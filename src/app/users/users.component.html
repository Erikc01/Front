<section  class="section-first-pages" align="center" style="padding: 0px">
	<div class="row">
		<div class="col m12 s12">
			<h1 class="h1-pages">Mis Autos</h1>
		</div>
	</div>
</section>
<section>
	<div class="row">
		<div class="col m1"></div>	
		<div class="col m10">
			<div class="row">
				<div class="col m3">
					<div class="card hoverable">
						<div class="card-content">
							<div *ngIf="car!=null" class="row">
								<div class="col m12" align="center">
									<img style="width: 150px" src="/assets/img/makers/{{car.maker}}.png" alt=""> <br>
									<span  class="bold-opensans">{{car.maker}} {{car.model}} {{car.version}} {{car.year}}</span>
									<br><br>
								</div>
								<div class="col m12" align="left">
									Placa: {{car.plates}}<br>
									Año: {{car.year}}<br>
									VIN: {{car.vin}}<br>
									<!--IMEI:{{car.}}<br>-->
									No. póliza:{{car.policy.policy_number}}<br>
									No. folio: AIG-{{car.policy.aig_id}}<br>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col m9">
					<div class="row">
						<div class="col m12">
							<ul class="tabs">
						        <li class="tab col s3"><a class="active" href="#test1">Detalle</a></li>
						        <li class="tab col s3"><a href="#test3">Mi auto</a></li>
						        <li class="tab col s3"><a href="#test4">Transacciones</a></li>
						        <li class="tab col s3"><a href="#test5">Viajes</a></li>
						    </ul>
						</div>
						<div class="col m12">
							<div id="test1" class="col s12">
								<div *ngIf="car!=null" class="row">
									<div class="col m4">Perfil de manejo</div>
									<div class="col m4">
										Tus kilómetros
									</div>
									<div class="col m4">
										Membresía SXKM <br>

										Status <br>
										{{car.policy.human_state}} <br>
										Fecha: {{car.policy.began_at | date:'dd/MM/yyyy'}} <br>
										Próxima renovación - {{car.policy.expires_at | date:'dd/MM/yyyy'}}<br>
										<a href="http://192.168.15.219:3000/polizas/certificado?policy_token={{car.policy.policy_token}}&identifier={{car.policy.user_id}}" target="_blank" class="btn btn-green" style="height:auto">Descargar póliza</a>
									</div>
								</div>
							</div>
						    <div id="test3" class="col s12">Mi auto</div>
						    <div id="test4" class="col s12">
						    	<span class="bold-opensans">RECARGA DE KILOMETROS</span> <br><br>
								<table class="table" *ngIf="purchases!=null">
								  <thead>
								    <tr>
								      <th scope="col">Fecha</th>
								      <th scope="col">Movimiento</th>
								      <th scope="col">Monto</th>
								    </tr>
								  </thead>
								  <tbody>
								    <tr *ngFor="let purchase of purchases | paginate: { id:'recharge', itemsPerPage: 2, currentPage: q }">
								      <td>{{purchase.created_at | date:'dd/MM/yyyy'}}</td>
								      <td>{{purchase.kilometers}} kilometros</td>
								      <td>${{purchase.cost}}</td>
								    </tr>
								  </tbody>
								</table>
								<br>
								<pagination-controls *ngIf="purchases!=null" style="width:100%; margin-left:50%;" (pageChange)="q = $event" id="recharge" autoHide="true"
								previousLabel="Anterior"
								nextLabel="Siguiente"
								screenReaderPaginationLabel="Pagination"
								screenReaderPageLabel="page"
								screenReaderCurrentLabel="Actual"> </pagination-controls>
								<br><br>
								<span class="bold-opensans">PAGO DE MENSUALIDADES</span>
								<table class="table" *ngIf="car.policy.get_monthly_payments!=null">
									<thead>
										<tr>
											<th scope="col">Fecha </th>
											<th scope="col">Movimiento</th>
											<th scope="col">Monto</th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let monthly of car.policy.get_monthly_payments | paginate: { id:'month', itemsPerPage: 3, currentPage: p }">
											<td>{{monthly.paid_at_date | date:'dd/MM/yyyy'}}</td>
											<td>Pago de Membresia</td>
											<td>${{monthly.amount}}</td>
										</tr>
									</tbody>
								</table>
								<br>
								<pagination-controls (pageChange)="p = $event" id="month" directionLinks="true"
		                      	autoHide="true"
		                      	previousLabel="Anterior"
		                      	nextLabel="Siguiente"
		                      	screenReaderPaginationLabel="Pagination"
		                      	screenReaderPageLabel="page"
		                      	screenReaderCurrentLabel="Actual" > </pagination-controls>
						    </div>
						    <div id="test5" class="col m12">
								<div class="row" *ngIf="view_trips == 1" style="padding-top: 30px; padding-bottom:30px;">
									<div class="col m4 space-input push-m4">
										<label for="nip">Ingresa tu NIP</label>
											<div class="input-group">
											<input type="text"  class="form-control {{error_nip==''? '':'invalid border-danger'}}" [(ngModel)]="nip" name="nip" id="nip">
											</div>
										<label *ngIf=" error_nip!='' " for="nip" class="invalid">{{error_nip}}</label>
									</div>
									<div class="col m12 space-input push-m5">
									<button type="button" class="btn btn-green" style="height:auto; margin-top:10px;" (click)="validate_nip()">Enviar</button>
									</div>
								</div>
								<div class="row" *ngIf="list_trips == false" style="padding-bottom: 30px; padding-top: 30px;">
									<div class="col m4 space-input push-m2">
										<!-- <input type="text" class="form-control" placeholder="Buscar viaje por fecha" [(ngModel)] = "searchTerm" (ngModelChange) = "search()"> -->
										<input type="date" class="form-control" #date>
										<button type="button" class="btn btn-green" style="height:auto; margin-top:10px;" (click)="get_trips_by_date(date.value)">Buscar</button>
									</div>
									<div class="col m12">
										<div *ngIf="trips">
											<table class="table table-hover">
												<thead>
												<tr>
													<th scope="col">Fecha</th>
													<th scope="col">Distancia</th>
													<th scope="col">Puntaje PIA</th>
													<th scope="col">Origen</th>
													<th scope="col">Destino</th>
												</tr>
												</thead>
												<tbody>
												<tr *ngFor="let item of trips | paginate: { id:'recharge', itemsPerPage: 3, currentPage: t }"
												(click)="get_trip_details(item.id)" style="cursor: pointer;">
													<td scope="col">{{item.started_at | date:'dd/MM/yyyy HH:MM:SS'}}</td>
													<td scope="col">{{item.distance}} km</td>
													<td scope="col">{{item.fuel_used}}</td>
													<td scope="col">{{item.origin.address}}</td>
													<td scope="col">{{item.destination.address}}</td>
												</tr>
												</tbody>
											</table>
											<pagination-controls style="width:100%; margin-left:50%;" (pageChange)="t = $event" id="recharge" autoHide="true"
											previousLabel="Anterior"
											nextLabel="Siguiente"
											screenReaderPaginationLabel="Pagination"
											screenReaderPageLabel="page"
											screenReaderCurrentLabel="Actual"> </pagination-controls>
										</div>				
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal" id="detalle_viaje" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" style="color:black; width:100%; text-align:center;">Detalle de viaje</h5>
					<!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span style="color:white" aria-hidden="true">&times;</span>
					</button> -->
				</div>
				<div class="row">
					<div class="col s12 m7 l8 xl8" id="map" style="height: 600px; width: 500px;">
						
					</div>
					<div class="col s12 m5 l4 xl4">
						<h5 style="text-align: center;">Puntaje PIA</h5>
						<ul>
							<li>Frenado brusco:</li>
							<li>Acelerado brusco:</li>
							<li>Exceso de velocidad:</li>
						</ul>

						<h5 style="text-align: center;">Especificaciones del viaje</h5>
						<h6>{{date_trip | date:'dd/MM/yyyy HH:MM:SS'}}</h6>
						<p>{{start_trip}}</p>
						<p>{{end_trip}}</p>
						<ul>
							<li>Tiempo detenido:  segundos</li>
							<li>Velocidad promedio:  km/hr</li>
							<li>Velocidad maxima:    km/hr</li>
						</ul>
					</div>
				</div>
				<!-- <div class="modal-footer">
					<button type="button" class="btn btn-green" data-dismiss="modal">Cerrar</button>
				</div> -->
			</div>
		</div>
	</div>
</section>
			